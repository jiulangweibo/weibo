STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b,c){var d=a.core.util.language(b,$LANG);d=d.replace(/\\}/ig,"}");c&&(d=a.templet(d,c));return d}});
STK.register("ui.mod.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b},c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else e=a.core.dom.position(c);if(d!=="topleft"){var f=b(c);if(d==="topright")e.l=e.l+f.w;else if(d==="bottomleft")e.t=e.t+f.h;else if(d==="bottomright"){e.l=e.l+f.w;e.t=e.t+f.h}}return e};return function(d){var e=a.core.dom.builder(d),f=e.list.outer[0],g=e.list.inner[0],h=a.core.dom.uniqueID(f),i={},j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k)k=b.apply(i,[f]);return k};i.html=function(a){a!==undefined&&(g.innerHTML=a);return g.innerHTML};i.text=function(b){b!==undefined&&(g.innerHTML=a.core.str.encodeHTML(b));return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){return e.list[a]?e.list[a][b||0]:!1};i.getCascadeDom=function(b,c){return e.list[b]?a.core.dom.cascadeNode(e.list[b][c||0]):!1};return i}});
STK.register("kit.extra.reuse",function(a){return function(b,c){var d,e,f;d=a.parseParam({},c);f=[];var g=function(){var a=b();f.push({store:a,used:!0});return a},h=function(b){a.foreach(f,function(a,c){if(b===a.store){a.used=!0;return!1}})},i=function(b){a.foreach(f,function(a,c){if(b===a.store){a.used=!1;return!1}})},j=function(){for(var a=0,b=f.length;a<b;a+=1)if(f[a].used===!1){f[a].used=!0;return f[a].store}return g()};e={};e.setUsed=h;e.setUnused=i;e.getOne=j;e.getLength=function(){return f.length};return e}});
STK.register("ui.mod.dialog",function(a){return function(b,c){if(!b)throw"ui.mod.dialog need template as first parameter";var d,e,f,g,h,i,j,k,l,m,n,o;l=!0;var p=function(){l!==!1&&e.hide()},q=function(){d=a.parseParam({t:null,l:null,width:null,height:null},c);e=a.ui.mod.layer(b,d);g=e.getOuter();h=e.getDom("title");k=e.getDom("title_content");i=e.getDom("inner");j=e.getDom("close");a.addEvent(j,"click",function(b){a.preventDefault(b);n();return!1});a.custEvent.add(e,"show",function(){a.hotKey.add(document.documentElement,["esc"],p,{type:"keyup",disableInInput:!0})});a.custEvent.add(e,"hide",function(){a.hotKey.remove(document.documentElement,["esc"],p,{type:"keyup"});l=!0})};q();o=a.objSup(e,["show","hide"]);n=function(b){if(typeof m=="function"&&!b&&m()===!1)return!1;o.hide();a.contains(document.body,e.getOuter())&&document.body.removeChild(e.getOuter());return f};f=e;f.show=function(){a.contains(document.body,e.getOuter())||document.body.appendChild(e.getOuter());o.show();return f};f.hide=n;f.setPosition=function(a){g.style.top=a.t+"px";g.style.left=a.l+"px";return f};f.setMiddle=function(){var b=a.core.util.winSize(),c=e.getSize(!0),d=a.core.util.scrollPos().top+(b.height-c.h)/2;g.style.top=(d>0?d:0)+"px";g.style.left=(b.width-c.w)/2+"px";return f};f.setTitle=function(a){k.innerHTML=a;return f};f.setContent=function(a){typeof a=="string"?i.innerHTML=a:i.appendChild(a);return f};f.clearContent=function(){while(i.children.length)a.removeNode(i.children[0]);return f};f.setAlign=function(){};f.setBeforeHideFn=function(a){m=a};f.clearBeforeHideFn=function(){m=null};f.unsupportEsc=function(){l=!1};f.supportEsc=function(){l=!0};return f}});
STK.register("kit.dom.fix",function(a){function f(c,e,f){if(!!d(c)){var g="fixed",h,i,j,k,l=c.offsetWidth,m=c.offsetHeight,n=a.core.util.winSize(),o=0,p=0,q=a.core.dom.cssText(c.style.cssText);if(!b){g="absolute";var r=a.core.util.scrollPos();o=h=r.top;p=i=r.left;switch(e){case"lt":h+=f[1];i+=f[0];break;case"lb":h+=n.height-m-f[1];i+=f[0];break;case"rt":h+=f[1];i+=n.width-l-f[0];break;case"rb":h+=n.height-m-f[1];i+=n.width-l-f[0];break;case"c":default:h+=(n.height-m)/2+f[1];i+=(n.width-l)/2+f[0]}j=k=""}else{h=k=f[1];i=j=f[0];switch(e){case"lt":k=j="";break;case"lb":h=j="";break;case"rt":i=k="";break;case"rb":h=i="";break;case"c":default:h=(n.height-m)/2+f[1];i=(n.width-l)/2+f[0];k=j=""}}if(e=="c"){h<o&&(h=o);i<p&&(i=p)}q.push("position",g).push("top",h+"px").push("left",i+"px").push("right",j+"px").push("bottom",k+"px");c.style.cssText=q.getCss()}}function e(b){b=a.core.arr.isArray(b)?b:[0,0];for(var c=0;c<2;c++)typeof b[c]!="number"&&(b[c]=0);return b}function d(b){return a.core.dom.getStyle(b,"display")!="none"}var b=!(a.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),c=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(d,g,h){var i,j,k=!0,l;if(a.core.dom.isNode(d)&&c.test(g)){var m={getNode:function(){return d},isFixed:function(){return k},setFixed:function(a){(k=!!a)&&f(d,i,j);return this},setAlign:function(a,b){if(c.test(a)){i=a;j=e(b);k&&f(d,i,j)}return this},destroy:function(){b||b&&a.core.evt.removeEvent(window,"scroll",n);a.core.evt.removeEvent(window,"resize",n);a.core.evt.custEvent.undefine(l)}};l=a.core.evt.custEvent.define(m,"beforeFix");m.setAlign(g,h);function n(c){c=c||window.event;a.core.evt.custEvent.fire(l,"beforeFix",c.type);k&&(!b||i=="c")&&f(d,i,j)}b||a.core.evt.addEvent(window,"scroll",n);a.core.evt.addEvent(window,"resize",n);return m}}});
STK.register("ui.mask",function(a){function k(b){var c;(c=b.getAttribute(f))||b.setAttribute(f,c=a.getUniqueKey());return">"+b.tagName.toLowerCase()+"["+f+'="'+c+'"]'}function j(){b=a.C("div");var c='<div node-type="outer">';a.core.util.browser.IE6&&(c+='<div style="position:absolute;width:100%;height:100%;"></div>');c+="</div>";b=a.builder(c).list.outer[0];document.body.appendChild(b);e=!0;d=a.kit.dom.fix(b,"lt");var f=function(){var c=a.core.util.winSize();b.style.cssText=a.core.dom.cssText(b.style.cssText).push("width",c.width+"px").push("height",c.height+"px").getCss()};i.add(d,"beforeFix",f);f()}var b,c=[],d,e=!1,f="STK-Mask-Key",g=a.core.dom.setStyle,h=a.core.dom.getStyle,i=a.core.evt.custEvent,l={getNode:function(){return b},show:function(c,f){if(e){c=a.core.obj.parseParam({opacity:.3,background:"#000000"},c);b.style.background=c.background;g(b,"opacity",c.opacity);b.style.display="";d.setAlign("lt");f&&f()}else{j();l.show(c,f)}return l},hide:function(){b.style.display="none";c=[];return l},showUnderNode:function(d,e){a.isNode(d)&&l.show(e,function(){g(b,"zIndex",h(d,"zIndex"));var e=k(d),f=a.core.arr.indexOf(c,e);f!=-1&&c.splice(f,1);c.push(e);a.core.dom.insertElement(d,b,"beforebegin")});return l},back:function(){if(c.length<1)return l;var d,e;c.pop();if(c.length<1)l.hide();else if((e=c[c.length-1])&&(d=a.sizzle(e,document.body)[0])){g(b,"zIndex",h(d,"zIndex"));a.core.dom.insertElement(d,b,"beforebegin")}else l.back();return l},destroy:function(){i.remove(d);b.style.display="none"}};return l});
STK.register("kit.dom.drag",function(a){return function(b,c){var d,e,f,g,h,i,j,k,l=function(){m();n()},m=function(){d=a.parseParam({moveDom:b,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},c);f=d.moveDom;e={};g={};h=a.drag(b,{actObj:d.actObj});if(d.dragtype==="perch"){i=a.C("div");j=!1;k=!1;f=i}b.style.cursor="move"},n=function(){a.custEvent.add(d.actObj,"dragStart",o);a.custEvent.add(d.actObj,"dragEnd",p);a.custEvent.add(d.actObj,"draging",q)},o=function(c,e){document.body.style.cursor="move";var f=a.core.util.pageSize().page;g=a.core.dom.position(d.moveDom);g.pageX=e.pageX;g.pageY=e.pageY;g.height=d.moveDom.offsetHeight;g.width=d.moveDom.offsetWidth;g.pageHeight=f.height;g.pageWidth=f.width;if(d.dragtype==="perch"){var h=[];h.push(d.perchStyle);h.push("position:absolute");h.push("z-index:"+(d.moveDom.style.zIndex+10));h.push("width:"+d.moveDom.offsetWidth+"px");h.push("height:"+d.moveDom.offsetHeight+"px");h.push("left:"+g.l+"px");h.push("top:"+g.t+"px");i.style.cssText=h.join(";");k=!0;setTimeout(function(){if(k){document.body.appendChild(i);j=!0}},100)}b.setCapture!==undefined&&b.setCapture()},p=function(a,c){document.body.style.cursor="auto";b.setCapture!==undefined&&b.releaseCapture();if(d.dragtype==="perch"){k=!1;d.moveDom.style.top=i.style.top;d.moveDom.style.left=i.style.left;if(j){document.body.removeChild(i);j=!1}}},q=function(a,b){var c=g.t+(b.pageY-g.pageY),e=g.l+(b.pageX-g.pageX),h=c+g.height,i=e+g.width,j=g.pageHeight-d.pagePadding,k=g.pageWidth-d.pagePadding;if(h<j&&c>0)f.style.top=c+"px";else{var l;h>=j&&(l=j-g.height);if(c<0||l<0)l=0;f.style.top=l+"px"}if(i<k&&e>0)f.style.left=e+"px";else{e<0&&(f.style.left="0px");i>=k&&(f.style.left=k-g.width+"px")}};l();e.destroy=function(){document.body.style.cursor="auto";typeof f.setCapture=="function"&&f.releaseCapture();if(d.dragtype==="perch"){k=!1;if(j){document.body.removeChild(i);j=!1}}a.custEvent.remove(d.actObj,"dragStart",o);a.custEvent.remove(d.actObj,"dragEnd",p);a.custEvent.remove(d.actObj,"draging",q);h.destroy&&h.destroy();d=null;f=null;g=null;h=null;i=null;j=null;k=null};e.getActObj=function(){return d.actObj};return e}});
STK.register("ui.dialog",function(a){var b='<div class="W_layer" node-type="outer" style="display:none;position:absolute;z-index:10001"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tr><td><div class="content" node-type="layoutContent"><div class="title" node-type="title"><span node-type="title_content"></span></div><a href="javascript:void(0);" class="W_ico16 W_close" title="#L{关闭}" node-type="close"></a><div node-type="inner"></div></div></td></tr></table></div></div>',c=a.kit.extra.language,d=null,e,f=function(){var b=a.ui.mod.dialog(c(e.template));a.custEvent.add(b,"show",function(){a.ui.mask.showUnderNode(b.getOuter())});a.custEvent.add(b,"hide",function(){a.ui.mask.back();b.setMiddle()});a.kit.dom.drag(b.getDom("title"),{actObj:b,moveDom:b.getOuter()});b.destroy=function(){g(b);try{b.hide(!0)}catch(a){}};return b},g=function(a){a.setTitle("").clearContent();d.setUnused(a)};return function(c){e=a.parseParam({template:b,isHold:!1},c);var h=e.isHold;e=a.core.obj.cut(e,["isHold"]);d||(d=a.kit.extra.reuse(f));var i=d.getOne();h||a.custEvent.add(i,"hide",function(){a.custEvent.remove(i,"hide",arguments.callee);g(i)});return i}});
STK.register("kit.io.vipAjax",function($){return function(oOpts){var opts=$.core.obj.parseParam({url:"",charset:"UTF-8",timeout:3e4,args:{},onComplete:null,onTimeout:$.core.func.empty,uniqueID:null,onFail:$.core.func.empty,method:"get",asynchronous:!0,header:{},isEncode:!1,responseType:"json"},oOpts);if(opts.url=="")throw"ajax need url in parameters object";var tm,trans=$.core.io.getXHR(),setTimeoutTimer=function(){opts.timeout&&(tm=setTimeout(function(){try{trans.abort();opts.onTimeout({},trans);opts.onFail({},trans)}catch(a){}},opts.timeout))},cback=function(){if(trans.readyState==4){clearTimeout(tm);var data="";if(opts.responseType==="xml")data=trans.responseXML;else if(opts.responseType==="text")data=trans.responseText;else try{trans.responseText&&typeof trans.responseText=="string"?data=eval("("+trans.responseText+")"):data={}}catch(exp){data=opts.url+"return error : data error"}trans.status==200?opts.onComplete!=null&&opts.onComplete(data):trans.status!=0&&opts.onFail!=null&&opts.onFail(data,trans)}else opts.onTraning!=null&&opts.onTraning(trans)};trans.onreadystatechange=cback;opts.header["Content-Type"]||(opts.header["Content-Type"]="application/x-www-form-urlencoded");opts.header["X-Requested-With"]||(opts.header["X-Requested-With"]="XMLHttpRequest");if(opts.method.toLocaleLowerCase()=="get"){var url=$.core.util.URL(opts.url,{isEncodeQuery:opts.isEncode});url.setParams(opts.args);url.setParam("__rnd",(new Date).valueOf());trans.open(opts.method,url.toString(),opts.asynchronous);try{for(var k in opts.header)trans.setRequestHeader(k,opts.header[k])}catch(exp){}setTimeoutTimer();trans.send("")}else{trans.open(opts.method,opts.url,opts.asynchronous);try{for(var k in opts.header)trans.setRequestHeader(k,opts.header[k])}catch(exp){}setTimeoutTimer();trans.send($.core.json.jsonToQuery(opts.args,opts.isEncode))}return trans}});
STK.register("kit.io.ajax",function(a){var b=function(b,c,d){c=c|0||1;d=d||"fail";var e=b.args;e.__rnd&&delete e.__rnd;(new Image).src="http://weibolog.sinaapp.com/?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d};return function(c){var d={},e=[],f=null,g=!1,h=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0,asynchronous:!0},c);h.onComplete=function(a){g=!1;c.onComplete(a,h.args);setTimeout(i,0)};h.onFail=function(a){g=!1;if(typeof c.onFail=="function")try{c.onFail(a,h.args)}catch(d){}setTimeout(i,0);try{b(h)}catch(d){}};h.onTimeout=function(a){try{b(h);c.onTimeout(a)}catch(d){}};var i=function(){if(!!e.length){if(g===!0)return;g=!0;h.args=e.shift();if(h.method.toLowerCase()=="post"){var b=a.core.util.URL(h.url);b.setParam("__rnd",+(new Date));h.url=b.toString()}f=a.kit.io.vipAjax(h)}},j=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d.request=function(a){a||(a={});c.noQueue&&j();if(!c.uniqueRequest||!f){e.push(a);a._t=0;i()}};d.abort=j;return d}});
STK.register("kit.io.jsonp",function(a){return function(b){var c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b),d=[],e={},f=!1,g=function(){if(!!d.length){if(f===!0)return;f=!0;e.args=d.shift();e.onComplete=function(a){f=!1;c.onComplete(a,e.args);setTimeout(g,0)};e.onFail=function(a){f=!1;c.onFail(a);setTimeout(g,0)};a.jsonp(a.core.json.merge(c,{args:e.args,onComplete:function(a){e.onComplete(a)},onFail:function(a){try{e.onFail(a)}catch(b){}}}))}},h={};h.request=function(a){a||(a={});d.push(a);a._t=1;g()};h.abort=function(a){while(d.length)d.shift();f=!1;e=null};return h}});
STK.register("kit.io.ijax",function(a){return function(b){var c=a.parseParam({url:"",timeout:3e4,isEncode:!0,abaurl:null,responseName:null,varkey:"callback",abakey:"callback"},b),d=[],e=null,f=!1;c.onComplete=function(a,d){f=!1;b.onComplete(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};c.onFail=function(a,d){f=!1;b.onFail(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};var g=function(){var b;if(!!d.length){if(f===!0)return;f=!0;b=d.shift();c.args=b.args;c.form=b.form;e=a.ijax(c)}},h=function(a){while(d.length)d.shift();f=!1;if(e)try{e.abort()}catch(b){}e=null},i={};i.request=function(c,e){if(!a.isNode(c))throw"[kit.io.ijax.request] need a form as first parameter";e||(e={});b.noQueue&&h();d.push({form:c,args:e});g()};i.abort=h;return i}});
STK.register("kit.io.inter",function(a){var b=a.core.json.merge;return function(){var c={},d={},e={},f=a.ui.dialog(),g=function(b,c){return function(d,g){if(d.code=="20046"){a.core.util.browser.IE6?f.setContent('<iframe style="border:0px" src="http://weibo.com/a/verify/email?stage=home_verification&from=vip" height="260" width="400">'):f.setContent('<iframe style="border:0px" src="http://weibo.com/a/verify/email?stage=home_verification&from=vip" height="240" width="380">');f.show();f.setMiddle()}else{try{c.onComplete(d,g)}catch(h){}try{if(d.code==="100000")c.onSuccess(d,g);else{if(d.code==="100002"){location.href=d.data;return}c.onError(d,g)}}catch(h){}for(var i in e[b])try{e[b][i](d,g)}catch(h){}}}};c.register=function(a,b){if(typeof d[a]!="undefined")throw a+" registered";d[a]=b;e[a]={}};c.addHook=function(b,c){var d=a.core.util.getUniqueKey();e[b][d]=c;return d};c.rmHook=function(a,b){e[a]&&e[a][b]&&delete e[a][b]};c.getTrans=function(c,e){var f=b(d[c],e);f.onComplete=g(c,e);var h=d[c].requestMode,i="ajax";if(h==="jsonp"||h==="ijax")i=h;return a.kit.io[i](f)};c.request=function(c,e,f){var h=b(d[c],e);h.onComplete=g(c,e);h=a.core.obj.cut(h,["noqueue"]);h.args=f;var i=d[c].requestMode;return i==="jsonp"?a.jsonp(h):i==="ijax"?a.ijax(h):a.ajax(h)};return c}});
STK.register("common.trans.vip",function(a){var b=a.kit.io.inter(),c=b.register;c("vipshare",{url:"/aj/tobevip/js/mblog",method:"post"});c("birthvipshare",{url:"/aj/shareblog",method:"post"});c("guide",{url:"/aj/guide",method:"post"});c("getPage",{url:"/aj/game/cardlist",method:"get"});c("receive_code",{url:"/aj/game/receive",method:"get"});c("restoreFeed",{url:"/aj/recycle/recover",method:"post"});c("moreTrash",{url:"/aj/recycle/feedmore",method:"get"});c("changeView",{url:"/aj/changeview",method:"post"});c("alipayDut",{url:"/aj/pay/autopayclose",method:"post"});c("alipayDutBreakSign",{url:"/aj/pay/alipayunsign",method:"post"});return b});
STK.register("common.trans.relation",function(a){var b=a.kit.io.inter(),c=b.register;c("follow",{url:"/aj/follow",method:"post"});c("followuid",{url:"/aj/followuid",method:"post"});return b});
STK.register("kit.dom.cssText",function(a){var b=function(a,b){var c=(a+";"+b).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),d;while(c&&(d=c.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i)))c=c.replace(d[1]+d[2]+d[3],"");return c};return function(a){a=a||"";var c=[],d={push:function(a,b){c.push(a+":"+b);return d},remove:function(a){for(var b=0;b<c.length;b++)c[b].indexOf(a+":")==0&&c.splice(b,1);return d},getStyleList:function(){return c.slice()},getCss:function(){return b(a,c.join(";"))}};return d}});
STK.register("ui.mod.mask",function(a){function k(b){var c;(c=b.getAttribute(f))||b.setAttribute(f,c=a.getUniqueKey());return">"+b.tagName.toLowerCase()+"["+f+'="'+c+'"]'}function j(){b=a.C("div");var c='<div node-type="outer">';a.core.util.browser.IE6&&(c+='<div style="position:absolute;width:100%;height:100%;"></div>');c+="</div>";b=a.builder(c).list.outer[0];document.body.appendChild(b);e=!0;d=a.kit.dom.fix(b,"lt");var f=function(){var c=a.core.util.winSize();b.style.cssText=a.kit.dom.cssText(b.style.cssText).push("width",c.width+"px").push("height",c.height+"px").getCss()};i.add(d,"beforeFix",f);f()}var b,c=[],d,e=!1,f="STK-Mask-Key",g=a.core.dom.setStyle,h=a.core.dom.getStyle,i=a.core.evt.custEvent,l={getNode:function(){return b},show:function(c,f){if(e){c=a.core.obj.parseParam({opacity:.3,background:"#000000"},c);b.style.background=c.background;g(b,"opacity",c.opacity);b.style.display="";d.setAlign("lt");f&&f()}else{j();l.show(c,f)}return l},hide:function(){b.style.display="none";c=[];return l},showUnderNode:function(d,e){a.isNode(d)&&l.show(e,function(){g(b,"zIndex",h(d,"zIndex"));var e=k(d),f=a.core.arr.indexOf(c,e);f!=-1&&c.splice(f,1);c.push(e);a.core.dom.insertElement(d,b,"beforebegin")});return l},back:function(){if(c.length<1)return l;var d,e;c.pop();if(c.length<1)l.hide();else if((e=c[c.length-1])&&(d=a.sizzle(e,document.body)[0])){g(b,"zIndex",h(d,"zIndex"));a.core.dom.insertElement(d,b,"beforebegin")}else l.back();return l},destroy:function(){i.remove(d);b.style.display="none"}};return l});
STK.register("ui.alert",function(a){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="S_txt1" node-type="textLarge"></p><p class="S_txt2" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="W_btnv5_a" node-type="OK"></a></div></div>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.kit.extra.language,e=null,f=function(a,b){a.getDom("icon").className=b.icon;a.getDom("textLarge").innerHTML=b.textLarge;a.getDom("textSmall").innerHTML=b.textSmall;a.getDom("OK").innerHTML="<span>"+b.OKText+"</span>"};return function(g,h){var i,j,k,l,m;i=a.parseParam({title:d("#L{提示}"),icon:"warn",textLarge:g,textSmall:"",OK:a.funcEmpty,OKText:d("#L{确定}"),timeout:0},h);i.icon=c[i.icon];j={};e||(e=a.kit.extra.reuse(function(){var c=a.ui.mod.layer(d(b));return c}));k=e.getOne();l=a.ui.dialog();l.setContent(k.getOuter());l.setTitle(i.title);f(k,i);var n=function(b){a.preventDefault(b);l.hide()};a.addEvent(k.getDom("OK"),"click",n);a.custEvent.add(l,"hide",function(){a.custEvent.remove(l,"hide",arguments.callee);a.removeEvent(k.getDom("OK"),"click",n);e.setUnused(k);clearTimeout(m);i.OK()});i.timeout&&(m=setTimeout(l.hide,i.timeout));l.show().setMiddle();k.getDom("OK").focus();j.alt=k;j.dia=l;return j}});
STK.register("ui.timerNotice",function(a){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="S_txt1" node-type="textLarge"></p><p class="S_txt2" node-type="textSmall"></p></dd></dl></div>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.kit.extra.language,e=[],f=function(){var c=a.ui.mod.layer(d(b));e.push({alt:c,used:!0});return c},g=function(a){for(var b=0,c=e.length;b<c;b+=1)if(a===e[b].dia){e[b].used=!0;return}},h=function(a){for(var b=0,c=e.length;b<c;b+=1)if(a===e[b].dia){e[b].used=!1;return}},i=function(b){var c,d,g,i;d={};for(var j=0,k=e.length;j<k;j+=1)if(!e[j].used){e[j].used=!0;g=e[j].dia;break}g=g||f();i=a.ui.dialog();i.appendChild(g.getOuter());g.getDom("icon").className=b.icon;g.getDom("textLarge").innerHTML=b.textLarge;g.getDom("textSmall").innerHTML=b.textSmall;i.setTitle(b.title);a.custEvent.add(i,"hide",function(){b.OK();a.custEvent.remove(i,"hide",arguments.callee);a.custEvent.remove(i,"show",l);h(g)});var l=function(){setTimeout(i.hide,b.timer)};a.custEvent.add(i,"show",l);d.alt=g;d.dia=i;return d};return function(b,e){e=e||{};var f,g,h;f=a.parseParam({title:d("#L{提示}"),icon:"warn",textLarge:b,textSmall:"",OK:function(){},timer:3e3},e);f.icon=c[f.icon];g=i(f);g.dia.show().setMiddle();return g}});
STK.register("kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("kit.extra.textareaUtils",function(a){var b={},c=document.selection;b.selectionStart=function(a){if(!c)try{return a.selectionStart}catch(b){return 0}var d=c.createRange(),e,f,g=0,h=document.body.createTextRange();try{h.moveToElementText(a)}catch(b){}for(g;h.compareEndPoints("StartToStart",d)<0;g++)h.moveStart("character",1);return g};b.selectionBefore=function(a){return a.value.slice(0,b.selectionStart(a))};b.selectText=function(a,b,d){a.focus();if(!c)a.setSelectionRange(b,d);else{var e=a.createTextRange();e.collapse(1);e.moveStart("character",b);e.moveEnd("character",d-b);e.select()}};b.insertText=function(a,d,e,f){a.focus();f=f||0;if(!c){var g=a.value,h=e-f,i=h+d.length;a.value=g.slice(0,h)+d+g.slice(e,g.length);b.selectText(a,i,i)}else{var j=c.createRange();j.moveStart("character",-f);j.text=d}};b.replaceText=function(a,d){a.focus();var e=a.value,f=b.getSelectedText(a),g=f.length;if(f.length==0)b.insertText(a,d,b.getCursorPos(a));else{var h=b.getCursorPos(a);if(!c){var j=h+f.length;a.value=e.slice(0,h)+d+e.slice(h+g,e.length);b.setCursor(a,h+d.length);return}var i=c.createRange();i.text=d;b.setCursor(a,h+d.length)}};b.getCursorPos=function(a){var b=0;if(STK.core.util.browser.IE){a.focus();var d=null;d=c.createRange();var e=d.duplicate();e.moveToElementText(a);e.setEndPoint("EndToEnd",d);a.selectionStartIE=e.text.length-d.text.length;a.selectionEndIE=a.selectionStartIE+d.text.length;b=a.selectionStartIE}else if(a.selectionStart||a.selectionStart=="0")b=a.selectionStart;return b};b.getSelectedText=function(a){var b="",d=function(a){return a.selectionStart!=undefined&&a.selectionEnd!=undefined?a.value.substring(a.selectionStart,a.selectionEnd):""};window.getSelection?b=d(a):b=c.createRange().text;return b};b.setCursor=function(a,b,c){b=b==null?a.value.length:b;c=c==null?0:c;a.focus();if(a.createTextRange){var d=a.createTextRange();d.move("character",b);d.moveEnd("character",c);d.select()}else a.setSelectionRange(b,b+c)};b.unCoverInsertText=function(a,b,c){c=c==null?{}:c;c.rcs=c.rcs==null?a.value.length:c.rcs*1;c.rccl=c.rccl==null?0:c.rccl*1;var d=a.value,e=d.slice(0,c.rcs),f=d.slice(c.rcs+c.rccl,d==""?0:d.length);a.value=e+b+f;this.setCursor(a,c.rcs+(b==null?0:b.length))};return b});
STK.register("kit.extra.count",function(a){function b(b){var c=41,d=140,e=20,f=b,g=b.match(/http:\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/,:;@&=\?\~\#\%]*)*/gi)||[],h=0;for(var i=0,j=g.length;i<j;i++){var k=a.core.str.bLength(g[i]);if(/^(http:\/\/t.cn)/.test(g[i]))continue;/^(http:\/\/)+(t.sina.com.cn|t.sina.cn)/.test(g[i])||/^(http:\/\/)+(weibo.com|weibo.cn)/.test(g[i])?h+=k<=c?k:k<=d?e:k-d+e:h+=k<=d?e:k-d+e;f=f.replace(g[i],"")}var l=Math.ceil((h+a.core.str.bLength(f))/2);return l}return function(a){a=a.replace(/\r\n/g,"\n");return b(a)}});
STK.register("ui.mod.editor",function(a){var b=a.core.evt.addEvent,c=a.core.evt.custEvent,d=a.core.dom.getStyle,e=a.core.dom.setStyle;return function(b,c){var d={},c=c,e={},f="",g="",h="",i={reset:function(){e.textEl.value="";a.core.evt.custEvent.fire(d,"changed");e.textEl.removeAttribute("extra");f=g=h=""},delWords:function(a){var b=i.getWords();if(!(b.indexOf(a)>-1))return!1;e.textEl.value="";k.textInput(b.replace(a,""))},getWords:function(){return a.core.str.trim(e.textEl.value)},getExtra:function(){var b,c=e.textEl.getAttribute("extra")||"";c!=null&&(b=a.core.str.trim(c));return b},focus:function(b,c){if(typeof b!="undefined")a.kit.extra.textareaUtils.setCursor(e.textEl,b,c);else{var d=e.textEl.value.length;a.kit.extra.textareaUtils.setCursor(e.textEl,d)}j.cacheCurPos()},blur:function(){e.textEl.blur()},addExtraInfo:function(a){typeof a=="string"&&e.textEl.setAttribute("extra",a)},disableEditor:function(b){a.core.evt.removeEvent(e.textEl,"mouseup",j.cacheCurPos);if(b===!0)e.textEl.setAttribute("disabled","disabled");else{a.core.evt.addEvent(e.textEl,"mouseup",j.cacheCurPos);e.textEl.removeAttribute("disabled")}},getCurPos:function(){var a=e.textEl.getAttribute("range")||"0&0";return a.split("&")},count:function(){var b=a.core.str.trim(e.textEl.value).length==0?a.core.str.trim(e.textEl.value):e.textEl.value;return a.kit.extra.count(b)},addShortUrlLog:function(b){b=b&&a.trim(b);if(b){var c=new RegExp("^"+b+"$|"+"_"+b+"$|^"+b+"_|"+"_"+b+"_");c.test(f)||(f?f=f+"_"+b:f=b)}},getShortUrlLog:function(){return f},setCurrentLogType:function(a){g=a},getCurrentLogType:function(){return g},setImageLogType:function(a){h=a},getImageLogType:function(){return h}},j={textElFocus:function(){e.recommendTopic&&a.core.dom.setStyle(e.recommendTopic,"display","none");a.custEvent.fire(d,"focus");e.num&&a.core.dom.setStyle(e.num,"display","block");i.getWords()==c.tipText&&i.delWords(c.tipText)},textElBlur:function(){setTimeout(function(){if(e.textEl.value.length===0){e.recommendTopic&&a.core.dom.setStyle(e.recommendTopic,"display","block");e.num&&e.recommendTopic&&a.core.dom.setStyle(e.num,"display","none");a.custEvent.fire(d,"blur");typeof c.tipText!="undefined"&&(e.textEl.value=c.tipText)}},50)},cacheCurPos:function(){var b=a.kit.extra.textareaUtils.getSelectedText(e.textEl),c=b==""||b==null?0:b.length,d=a.core.dom.textSelectArea(e.textEl).start,f=d+"&"+c;e.textEl.setAttribute("range",f)}},k={textChanged:function(){a.custEvent.fire(d,"keyUpCount")},textInput:function(b,f){var g=i.getCurPos(),f=g[0],h=g[1];i.getWords()==c.tipText&&b!=c.tipText&&i.delWords(c.tipText);a.kit.extra.textareaUtils.unCoverInsertText(e.textEl,b,{rcs:g[0],rccl:g[1]});j.cacheCurPos();a.core.evt.custEvent.fire(d,"changed")}},l={},m=function(){p();q()},n=function(){r();t();u();o()},o=function(){c.storeWords?e.textEl.value.length==0&&k.textInput(c.storeWords):c.tipText&&(e.textEl.value=c.tipText)},p=function(){if(!b)throw"node is not defined in module editor"},q=function(){var c=a.core.dom.builder(b).list;e=a.kit.dom.parseDOM(c)},r=function(){a.core.evt.addEvent(e.textEl,"focus",j.textElFocus);a.core.evt.addEvent(e.textEl,"blur",j.textElBlur);a.core.evt.addEvent(e.textEl,"mouseup",j.cacheCurPos);a.core.evt.addEvent(e.textEl,"keyup",j.cacheCurPos)},s=function(){a.core.evt.custEvent.define(d,"changed")},t=function(){s();a.core.evt.custEvent.add(d,"changed",k.textChanged)},u=function(){},v=function(){};m();var w={reset:i.reset,getWords:i.getWords,getExtra:i.getExtra,delWords:i.delWords,focus:i.focus,blur:i.blur,insertText:k.textInput,check:k.textChanged,addExtraInfo:i.addExtraInfo,disableEditor:i.disableEditor,getCurPos:i.getCurPos,count:i.count,textElFocus:j.textElFocus,cacheCurPos:j.cacheCurPos,addShortUrlLog:i.addShortUrlLog,getShortUrlLog:i.getShortUrlLog,setCurrentLogType:i.setCurrentLogType,getCurrentLogType:i.getCurrentLogType,setImageLogType:i.setImageLogType,getImageLogType:i.getImageLogType};d.destroy=v;d.API=w;d.nodeList=e;d.init=n;d.opts=c;return d}});
STK.register("common.editor.plugin.count",function(a){function e(a,b){if(!a.textEl)throw"[editor plugin count]: plz check nodeList"}function d(a){var d=c(a),e=Math.abs(b-d),f;d>b||d<1?f={wordsnum:d,vnum:e,overflow:!0}:d==0?f={wordsnum:d,vnum:e,overflow:!0}:f={wordsnum:d,vnum:e,overflow:!1};return f}function c(b){var c=41,d=140,e=20,f=b,g=b.match(/(http|https):\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\,\:;@&=\?~#%]*)*/gi)||[],h=0;for(var i=0,j=g.length;i<j;i++){var k=a.core.str.bLength(g[i]);if(/^(http:\/\/t.cn)/.test(g[i]))continue;/^(http:\/\/)+(t.sina.com.cn|t.sina.cn)/.test(g[i])||/^(http:\/\/)+(weibo.com|weibo.cn)/.test(g[i])?h+=k<=c?k:k<=d?e:k-d+e:h+=k<=d?e:k-d+e;f=f.replace(g[i],"")}var l=Math.ceil((h+a.core.str.bLength(f))/2);return l}var b;return function(c){var f=c.nodeList,g,h=c.opts,i=a.kit.extra.language;b=h.limitNum;e(f);a.core.evt.custEvent.define(c,"textNum");a.custEvent.define(c,"keyUpCount");var j=f.textEl,k=f.num?f.num:null;a.addEvent(j,"focus",function(){g=setInterval(function(){l()},200)});a.addEvent(j,"blur",function(){clearInterval(g)});var l=function(){var b=a.core.str.trim(j.value).length==0?a.core.str.trim(j.value):j.value,e=c&&c.opts&&c.opts.extendText;b=b.replace(/\r\n/g,"\n");var f=d(b,h.limitNum);k&&(b.length>=0&&j.focus?f.overflow&&f.wordsnum!=0?k.innerHTML=(e?i(e):"")+i("#L{已经超过}")+'<span class="W_error">'+f.vnum+"</span>字":k.innerHTML=(e?i(e):"")+i("#L{还可以输入}")+"<span>"+f.vnum+"</span>字":b.length===0&&(k.innerHTML=(e?i(e):"")+i("#L{还可以输入}")+"<span>"+f.vnum+"</span>字"));a.core.evt.custEvent.fire(c,"textNum",{count:f.wordsnum,isOver:f.overflow})};STK.core.evt.addEvent(j,"keyup",l);a.custEvent.add(c,"keyUpCount",l)}});
STK.register("kit.dom.isTurnoff",function(a){return function(a){return!a.parentNode||a.parentNode.nodeType==11||!!a.disabled}});
STK.register("ui.mod.at",function(a){var b=window,c=document,d=a.core.util.browser,e="font-family:Tahoma,宋体;",f=a.kit.extra.textareaUtils.selectionStart,g,h,i,j,k,l=function(){var a={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',e,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',e,'"> </span>'].join("")};return function(b){var c=b.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(b){return a[b]});return c}}(),m=function(){var b=[],c=g.textEl.style.cssText,d;a.foreach(["margin","padding","border"],function(c){a.foreach(["Top","Left","Bottom","Right"],function(d){var e;c!="border"?e=b.push(c,"-",d.toLowerCase(),":",a.getStyle(g.textEl,c+d),";"):a.foreach(["Style","Width"],function(e){b.push(c,"-",d.toLowerCase(),"-",e.toLowerCase(),":",a.getStyle(g.textEl,[c,d,e].join("")),";")})})});b.push("font-size:"+a.getStyle(g.textEl,"fontSize")+";");return a.kit.dom.cssText([c,b.join(""),e,"\n\t\t\tword-wrap: break-word;\n\t\t\tline-height: 18px;\n\t\t\toverflow-y:auto;\n\t\t\toverflow-x:hidden;\n\t\t\toutline:none;\n\t\t"].join("")).getCss()},n=function(){var b=a.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list,e=b.wrap[0],f=b.flag[0],h=b.after[0],i=b.before[0],j=0,n,o,p,q=function(a){return d.MOZ?-2:d.MOBILE&&d.SAFARI&&(d.IPAD||d.ITOUCH||d.IPHONE)?-2:0};return{bind:function(){if(o!==g.textEl){k=a.position(g.textEl);var b=["left:",k.l,"px;top:",k.t+20,"px;"].join("");o=g.textEl;var d=m();o.style.cssText=d;p=[b,d,"\n\t\t\t\t\tposition:absolute;\n\t\t\t\t\tfilter:alpha(opacity=0);\n\t\t\t\t\topacity:0;\n\t\t\t\t\tz-index:-1000;\n\t\t\t\t"].join("");e.style.cssText=p;if(!j){j=1;c.body.appendChild(e)}}},content:function(b,c,d,j){e.style.cssText=[p,"\n\t\t\t\t\twidth:",(parseInt(a.getStyle(o,"width"))||o.offsetWidth)+q(),"px;\n\t\t\t\t\theight:",parseInt(a.getStyle(o,"height"))||o.offsetHeight,"px;\n\t\t\t\t\toverflow-x:hidden;\n\t\t\t\t\toverflow-y:",/webkit/i.test(navigator.userAgent)?"hidden":a.getStyle(o,"overflowY"),";\n\t\t\t\t"].join("");i.innerHTML=l(b);f.innerHTML=l(c)||"&thinsp;";h.innerHTML=l([d,j].join(""));clearTimeout(n);n=setTimeout(function(){var b=a.position(f);a.custEvent.fire(g.eId,"at",{t:b.t-o.scrollTop-k.t,l:b.l-k.l,fl:b.l,key:d,flag:c,textarea:g.textEl})},30)},hide:function(){e.style.display="none"},show:function(){e.style.display=""}}}(),o=function(){if(a.kit.dom.isTurnoff(g.textEl))clearInterval(h);else{var b=g.textEl.value.replace(/\r/g,""),c=f(g.textEl);if(c<0||c==j)return;j=c;var d=b.slice(0,c),e=d.match(new RegExp(["(",g.flag,")([a-zA-Z0-9一-龥_-]{0,20})$"].join("")));if(!e){a.custEvent.fire(g.eId,"hidden");return}var i=b.slice(c);d=d.slice(0,-e[0].length);n.content(d,e[1],e[2],i)}};return function(b){if(!!b&&!!b.textEl){b=a.parseParam({textEl:null,flag:"@",eId:a.custEvent.define({},["at","hidden"])},b);var c=function(){if(!!g){clearInterval(h);a.removeEvent(g.textEl,"blur",c);n.hide()}},d=function(){c();g=b;j=null;n.bind();n.show();h=setInterval(o,200);a.addEvent(b.textEl,"blur",c)};a.addEvent(b.textEl,"focus",d);return b.eId}}});
STK.register("common.trans.global",function(a){var b=a.kit.io.inter(),c=b.register;c("language",{url:"/aj/user/lang",method:"post"});c("followList",{url:"/aj/mblog/attention"});c("topicList",{url:"/aj/mblog/topic"});return b});
STK.register("ui.mod.suggest",function(a){var b=null,c=a.custEvent,d=c.define,e=c.fire,f=c.add,g=a.addEvent,h=a.removeEvent,i=a.stopEvent,j=[],k={},l={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9},m=function(b){var c=-1,j=[],k=b.textNode,m=b.uiNode,n=a.core.evt.delegatedEvent(m),o=d(k,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);o.setFlag=p;var p=function(a){b.flag=a},q=function(){return a.sizzle(["[action-type=",b.actionType,"]"].join(""),m)},r=function(){c=-1;h(k,"keydown",s);n.destroy()},s=function(d){var f,g;if(!!(f=d)&&!!(g=f.keyCode)){if(g==l.ENTER){e(o,"onSelect",[c,k,b.flag]);a.preventDefault()}if(g==l.UP){i();var h=q().length;c=c<1?h-1:c-1;e(o,"onIndexChange",[c]);return!1}if(g==l.DOWN){i();var h=q().length;c=c==h-1?0:c+1;e(o,"onIndexChange",[c]);return!1}if(g==l.ESC){i();r();e(o,"onClose");return!1}if(g==l.TAB){r();e(o,"onClose");return!1}}},t=function(c){e(o,"onSelect",[a.core.arr.indexOf(c.el,q()),k,b.flag])},u=function(b){c=a.core.arr.indexOf(b.el,q());e(o,"onIndexChange",[a.core.arr.indexOf(b.el,q())])};f(o,"open",function(a,c){k=c;r();g(c,"keydown",s);n.add(b.actionType,"mouseover",u);n.add(b.actionType,"click",t);e(o,"onOpen",[b.flag])});f(o,"openSetFlag",function(a,b){p(b)});f(o,"close",function(){r();e(o,"onClose",[b.flag])});f(o,"indexChange",function(a,d){c=d;e(o,"onIndexChange",[c,b.flag])});return o},n=function(b){var c=b.textNode,d=a.core.arr.indexOf(c,j);if(!k[d]){j[d=j.length]=c;k[d]=m(b)}return k[d]};return function(c){if(!!c.textNode&&!!c.uiNode){c=a.parseParam({textNode:b,uiNode:b,actionType:"item",actionData:"index",flag:""},c);return n(c)}}});
STK.register("common.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"common.listener.define: 频道已被占用";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"common.listener.define: 频道未定义";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: 频道未定义";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("common.channel.at",function(a){var b=["open","close"];return a.common.listener.define("common.channel.at",b)});
STK.register("kit.dom.layoutPos",function(a){return function(b,c,d){if(!a.isNode(c))throw"kit.dom.layerOutElement need element as first parameter";if(c===document.body)return!1;if(!c.parentNode)return!1;if(c.style.display==="none")return!1;var e,f,g,h,i,j,k;e=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},d);f=c;if(!f)return!1;while(f!==document.body){f=f.parentNode;if(f.style.display==="none")return!1;j=a.getStyle(f,"position");k=f.getAttribute("layout-shell");if(j==="absolute"||j==="fixed")break;if(k==="true"&&j==="relative")break}f.appendChild(b);g=a.position(c,{parent:f});h={w:c.offsetWidth,h:c.offsetHeight};i=e.pos.split("-");i[0]==="left"?b.style.left=g.l+e.offsetX+"px":i[0]==="right"?b.style.left=g.l+h.w+e.offsetX+"px":i[0]==="center"&&(b.style.left=g.l+h.w/2+e.offsetX+"px");i[1]==="top"?b.style.top=g.t+e.offsetY+"px":i[1]==="bottom"?b.style.top=g.t+h.h+e.offsetY+"px":i[1]==="middle"&&(b.style.top=g.t+h.h/2+e.offsetY+"px");return!0}});
STK.register("common.editor.plugin.at",function(a){var b='<div style="" class="layer_menu_list"><ul node-type="suggestWrap"></ul></div>',c={"@":'<#et temp data><li class="suggest_title">想用@提到谁？</li><#list data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.screen_name}" value="${list.screen_name}"><a href="#">${list.screen_name}<#if (list.remark)>(${list.remark})</#if></a></li><#if (list.count)><span>${list.count}</span></#if></#list></#et>',"#":'<#et temp data><li class="suggest_title">想用什么话题？</li><#list data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.topic}" value="${list.topic}"><a href="#">${list.topic}<#if (list.count)>(${list.count})</#if></a></li></#list></#et>'},d,e,f,g,h,i,j=!1,k,l,m={"@":"followList","#":"topicList"},n=0,o=function(){setTimeout(function(){a.custEvent.fire(d,"close")},200)},p=function(){h.style.display="none"},q=function(){a.custEvent.add(d,"onIndexChange",function(a,b){u(b)});a.custEvent.add(d,"onSelect",function(b,c,e,f){a.core.evt.stopEvent();var g=l[c].getAttribute("value");g=g.replace(/\(.*\)/,"");try{e.focus()}catch(h){}var i=a.kit.extra.textareaUtils.selectionStart(e)*1,j=new RegExp(f+"([a-zA-Z0-9一-龥_]{0,20})$"),k=e.value.slice(0,i).match(j),m=e.value.slice(i,i+1);k=k&&k[1]?k[1].length:0;var n=a.kit.extra.textareaUtils;f=="#"?typeof m!="undefined"&&m!=f&&(g=g+f+" "):g=g+" ";n.insertText(e,g,i,k);var o=n.getCursorPos(e);if(f=="#"&&m==f){n.setCursor(e,o+1);n.insertText(e," ",o+1,0)}o=n.getCursorPos(e);var p=n.getSelectedText(e),q=p==""||p==null?0:p.length;e.setAttribute("range",o+"&"+q);a.custEvent.fire(d,"close")});a.addEvent(f.textEl,"blur",o);a.custEvent.add(d,"onClose",p);a.custEvent.add(d,"onOpen",function(b,c){g.style.display="";h.style.display="";j=!0;setTimeout(function(){a.custEvent.fire(d,"indexChange",0)},100)})},r=function(){a.core.evt.custEvent.add(e,"hidden",function(b,c){a.custEvent.fire(d,"close")});a.core.evt.custEvent.add(e,"at",function(b,e){i=e.key;if(i.length==0)a.custEvent.fire(d,"close");else var f=e.flag,j=a.common.trans.global.getTrans(m[f],{onSuccess:function(b,i){var j=a.core.util.easyTemplate(c[f],b.data);a.custEvent.fire(d,"openSetFlag",f);a.custEvent.fire(d,"open",e.textarea);var k=a.core.dom.builder(j),l=k.box;g.innerHTML=l;h.style.cssText=["z-index:11001;background-color:#ffffff;position:absolute;"].join("");a.common.channel.at.fire("open");a.kit.dom.layoutPos(h,e.textarea,{pos:"left-top",offsetX:e.l,offsetY:e.t})},onError:function(){a.custEvent.fire(d,"close")}}).request({q:i})})},s=function(){k=f.textEl;e=STK.ui.mod.at({textEl:k,flag:"@|#"})},t=function(c){h=STK.C("div");document.body.appendChild(h);if(h.innerHTML.length==0){h.innerHTML=b;g=a.core.dom.sizzle('[node-type="suggestWrap"]',h)[0];h.style.display="none"}d=a.ui.mod.suggest({textNode:c,uiNode:g,actionType:"item",actionData:"value",flag:"@"});q()},u=function(b){l=a.sizzle("li[class!=suggest_title]",g);a.core.dom.removeClassName(l[n],"cur");a.core.dom.addClassName(l[b],"cur");n=b};return function(b,c){f=b.nodeList;var d={};d.init=function(){s();t(f.textEl);r()};d.destroy=function(){a.removeEvent(f.textEl,"blur",o)};return d}});
STK.register("kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}});
STK.register("common.editor.base",function(a){function c(){}var b={limitNum:140};return function(c,d){var e={},f,g,h,i;f=a.kit.extra.merge(b,d);g=a.ui.mod.editor(c,f);h=g.nodeList;i=[];if(typeof d.count=="undefined"||d.count=="enable")var j=a.common.editor.plugin.count(g,f);if(typeof d.at=="undefined"||d.at=="enable"){var k=a.common.editor.plugin.at(g,f);k.init()}g.init();g.widget=function(a,b,c){i.push(a);a.init(g,b,c);return g};g.closeWidget=function(){if(i&&i.length!=0)for(var a=0,b=i.length;a<b;a++)i[a].hide()};return g}});
STK.register("common.dialog.vipGuide",function(a){var b={wrap:'<div class="W_vip_layer" node-type="outer" style="position:absolute;z-index=100;display:none"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="content"><a href="javascript:void(0);" class="vip_close" node-type="close"></a><div node-type="inner" class="vip_guide_layer"></div></div></td></tr></tbody></table></div></div>',opened:'<#et openT data><div class="tit">已成功开通会员</div><div class="textcon W_f14"><p class="v_pA">尊敬的微博会员<b class="color_spc2">${data.nickName}</b>你已开通微博<#if (data.payType==2)>年费</#if>会员，<#if (data.payType==1)>会员有效期到<b class="color_spc1">${data.endDate}</b>您当前的成长速度为<b class="color_spc1">${data.growPoint}点</b>/天 ，可享受会员特权服务。<#elseif (data.payType==2)>会员有效期到<b class="color_spc1">${data.endDate}</b>您当前的成长速度为<b class="color_spc1">${data.growPoint}点</b>/天 ，还可享受更多年费特权。<#else>您当前的成长速度为<b class="color_spc1">${data.growPoint}点</b>/天 ，可享受会员特权服务。您当前为手机包月用户，由运营商每月自动扣费续费。</#if></p></div><div class="btn_con clearfix"><a href="javascript:void(0);" class="btn_vipC" node-type="share"><span><b>分享</b></span></a></div><div class="other_box clearfix"><div class="fl W_f14"><span class="ico_year"></span>年费会员尊享<span class="W_fb color_spc1">15点/天</span>成长值，还可一次性获得<span class="W_fb color_spc1">200点</span>成长值</div><div class="fr"><div class="btn"><a href="${data.openUrl}" class="W_fb W_f16 CH">开通年费&gt;&gt;</a></div></div></div></#et>',update:'<div class="tit">会员升级</div><div class="textcon W_f14"><p class="v_pA">尊敬的微博会员<b class="color_spc2">#{nickName}</b>你已升级到微博<b class="color_spc1">VIP#{level}</b>级会员，当前成长值为<b class="color_spc1">#{growValue}</b>，</p><p class="v_pB">按当前<b class="color_spc1">#{growPoint}</b>点/天速度成长，下次升级还需<b class="color_spc1">#{needDay}天</b></p></div><div class="btn_con clearfix"><a href="javascript:void(0);" class="btn_vipC" node-type="share"><span><b>分享</b></span></a></div><div class="other_box clearfix"><div class="fl W_f14"><span class="ico_year"></span>年费会员尊享<span class="W_fb color_spc1">15点/天</span>成长值，还可一次性获得<span class="W_fb color_spc1">200点</span>成长值</div><div class="fr"><div class="btn"><a href="#{openUrl}" class="W_fb W_f16 CH">开通年费&gt;&gt;</a></div></div></div>',share:'<#et share data><div class="tit">会员${data.title}</div><div style="visibility:hidden;" node-type="num"><span>140</span>#L{字}</div><div class="textareacon W_f14"><textarea node-type="textEl" cols="" rows="" name="text">${data.text}</textarea></div><div class="btn_con btn_con2 clearfix"><label style="<#if (data.isFollowed)> display:none;</#if>"><input  checked = "checked" node-type="follow" uid = "2715025067" type="checkbox" />分享并关注微博会员</label><a href="javascript:void(0);" node-type="publish" class="btn_vipC"><span><b>发布</b></span></a></div></#et>'},c={opened:{isFollowed:!1,nickName:"",endDate:"",growPoint:10,openUrl:"/paycenter",title:"开通",payType:3,text:"真是太棒了！我刚刚成为VIP会员，微博会员享受多项特权服务，更多精彩尽在微博会员，赶快来加入我们吧！http://vip.weibo.com"},update:{isFollowed:!1,nickName:"",needDay:300,growValue:123,growPoint:10,openUrl:"/paycenter",level:1,title:"升级"}},d=a.kit.extra.language;return function(e,f){var g={},h,i,j,k,l,m,n,o=function(){var b=a.core.util.winSize(),c=h.getSize(!0);i.style.top=a.core.util.scrollPos().top+(b.height-c.h)/2+"px";i.style.left=(b.width-c.w)/2+"px"},p=function(){h.html(a.core.util.easyTemplate(b.share,j));l=a.sizzle('a[node-type="publish"]',h.getInner())[0];var c=a.common.editor.base(h.getOuter(),{count:"enable",at:"disable"});a.custEvent.add(c,"textNum",function(a,b){b.isOver?l.className="btn_vipC_dis":l.className="btn_vipC"});a.addEvent(l,"click",q);g.show()},q=function(){m||(m=a.sizzle('[node-type="textEl"]',i)[0]);if(a.trim(m.value).length==0){a.ui.alert(d("#L{请输入要分享的内容!}"));return!1}if(a.hasClassName(l,"btn_vipC_dis")){a.ui.alert(d("#L{糟糕，超过字数限制啦，删掉几个字试试吧。}"));return!1}var b=a.sizzle('[node-type="follow"]',h.getInner())[0],c=b.checked;a.common.trans.vip.getTrans("sharePublish",{onSuccess:function(e){c&&a.common.trans.relation.getTrans("follow",{}).request({uid:b.getAttribute("uid"),f:1,oid:$CONFIG.oid,fnick:d("#L{微博会员}")});a.ui.timerNotice("发布成功!!",{icon:"success",timer:2e3,OK:function(){g.hide()}})},onError:function(b){a.ui.alert(d(b.msg))}}).request({text:a.trim(m.value)})};g.init=function(){h=a.ui.mod.layer(b.wrap);i=h.getOuter();j=a.parseParam(c[e],f);a.addEvent(h.getDom("close"),"click",g.hide);if(e=="update"){j.text=d("真是太棒了！我刚刚升级成为VIP"+j.level+"会员，微博会员享受多项特权服务，更多精彩尽在微博会员，赶快来加入我们吧！http://vip.weibo.com");h.html(d(a.core.util.templet(b[e],j)))}else h.html(a.core.util.easyTemplate(b[e],j));k=a.sizzle('a[node-type="share"]',h.getInner())[0];a.addEvent(k,"click",p);document.body.appendChild(i)};g.show=function(){o();a.ui.mod.mask.showUnderNode(i);h.show()};g.hide=function(){h.hide();a.ui.mod.mask.back();l&&a.removeEvent(l,q,"click");k&&a.removeEvent(k,p,"click");a.removeEvent(h.getDom("close"),g.hide,"click");return!1};g.init();return g}});
STK.register("pl.general.top.source.init",function(a){var b=a.kit.extra.language;return function(b){var c,d,e,f,g,h,i,j,k={},l,m,n,o={DOM:{},objs:{},DOM_eventFun:{mouseoverNavLi:function(b){a.addClassName(b.el,"hover")},mouseoutNavLi:function(b){a.removeClassName(b.el,"hover")}}},p=function(){a.common.trans.vip.getTrans("guide",{onSuccess:function(b){l=a.strToJson(b.data);if(l.type==1){o.objs.dialog=a.pl.general.top.source.dialog.vipGuide("opened",{nickName:l.nick,endDate:l.endtime,growPoint:l.growspeed,level:l.level,payType:Number(l.paytype),isFollowed:l.is_follow});o.objs.dialog.show()}else if(l.type==2){o.objs.dialog=a.pl.general.top.source.dialog.vipGuide("update",{nickName:l.nick,needDay:l.upgradeday,growValue:l.growvalue,growPoint:l.growspeed,level:l.level,isFollowed:l.is_follow});o.objs.dialog.show()}},onError:function(a){}}).request()};c=function(){m=b.node;if(!m)throw new Error("pl.general.top.source.init [ERROR]:node没有定义")};d=function(){o.DOM=a.kit.dom.parseDOM(a.builder(m).list)};e=function(){p()};f=function(){n=a.core.evt.delegatedEvent(m);n.add("navLi","mouseover",o.DOM_eventFun.mouseoverNavLi);n.add("navLi","mouseout",o.DOM_eventFun.mouseoutNavLi)};g=function(){};h=function(){};i=function(){if(o){a.foreach(o.objs,function(a){a.destroy&&a.destroy()});o=null}};j=function(){c();d();e();f();g();h()};j();k.destroy=i;return k}});
STK.pageletM.register("pl.general.top.index",function(a){var b="pl_general_top",c=a.E(b),d=a.pl.general.top.source.init({node:c}),e={};e.destroy=function(){d.destroy()};return e});
STK.register("ui.mod.bubble",function(a){return function(b,c){var d,e,f,g,h,i,j;e=a.parseParam({width:null,height:null,parent:document.body},c);f=a.ui.mod.layer(b);g=f.getDom("outer");h=f.getDom("inner");f.getDomListByKey("close")&&(i=f.getDom("close"));g.style.display="none";j=!1;var k=function(b){if(j)return!0;var c=a.fixEvent(b);a.contains(g,c.target)||f.hide()};i&&a.addEvent(i,"click",f.hide);a.custEvent.add(f,"show",function(){setTimeout(function(){a.addEvent(document.body,"click",k)},0)});a.custEvent.add(f,"hide",function(){j=!1;a.removeEvent(document.body,"click",k)});d=f;d.setPosition=function(a){g.style.top=a.t+"px";g.style.left=a.l+"px";return d};d.setAlignPos=function(b,c,d){d=a.parseParam({offset:{left:0,top:0},arrowOffset:0,align:"left",fail:a.funcEmpty},d);if(!!a.isNode(b)&&!!a.isNode(c)){var e=b,h;while(e!==document.body){e=e.parentNode;h=a.getStyle(e,"position");if(h==="absolute")break}e.appendChild(g);h=a.position(e);h||(h={l:0,t:0});var i=a.core.dom.getSize,j=a.position(c),k=a.position(b),l=i(b),m=6,n=14,o,p,q,r=d.offset,s=d.arrowOffset,t=i(g),u=i(c),v=2;if(d.align==="left"){if(t.width<k.l-j.l+Math.ceil(l.width/2)){d.fail();return}}else if(j.l+u.width-k.l-Math.ceil(l.width/2)>t.width){d.fail();return}d.align==="left"?o=j.l-v:o=j.l+u.width-t.width+v;p=k.t+l.height+m;q=k.l+Math.ceil((l.width-n)/2)-o;p-=h.t;o-=h.l;p+=r.top;o+=r.left;q+=s;g.style.left=o+"px";g.style.top=p+"px";if(f.getDomListByKey("arrow")){arrow=f.getDom("arrow");arrow.style.left=q+"px"}}};d.setLayout=function(b,c){if(!a.isNode(b))throw"ui.mod.bubble.setDown need element as first parameter";if(f.getDomListByKey("arrow")){arrow=f.getDom("arrow");arrow.style.cssText=""}a.kit.dom.layoutPos(g,b,c);return d};d.setContent=function(b){typeof b=="string"?h.innerHTML=b:a.isNode(b)&&h.appendChild(b);return d};d.setArrow=function(a){var b;if(f.getDomListByKey("arrow")){b=f.getDom("arrow");a.className&&(b.className=a.className||"");a.style&&(b.style.cssText=a.style||"")}};d.clearContent=function(){while(h.children.length)a.removeNode(h.children[0])};d.stopBoxClose=function(){j=!0};d.startBoxClose=function(){j=!1};d.destroy=function(){a.removeEvent(document.body,"click",k);f=null;g=null;h=null;i=null};return d}});
STK.register("pl.general.top.source.dialog.vipGuide",function(a){var b={wrap:'<div node-type="outer" class="layer_year_border" style="position:absolute;z-index=100000;display:none;"><div class="W_layer bg_1"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td><div class="content layer_mini_info clearfix"><div node-type="inner" class="box_year"></div></div></td></tr></tbody></table><div node-type="arrow" class="arrow arrow_t"></div></div></div></div>',year:'<p>开通年费会员，享受<span class="color_spc1">15点</span>/天 成长速度，还可以获得<span class="color_spc1">200点</span>成长值奖励</p>',moblie:'<p>您当前为手机包月用户，想开通年费会员需先取消包月 <a class="color_spc1" href="http://help.weibo.com/faq/q/1148">查看详情</a></p>'},c=a.kit.extra.language;return function(d,e){var f={},g,h,i,j,k=function(){j&&window.clearTimeout(j)};f.init=function(){g=a.ui.mod.bubble(c(b.wrap));h=g.getOuter();g.setContent(c(b[e]));document.body.appendChild(h);a.addEvent(h,"mouseover",k);a.addEvent(h,"mouseout",f.hide)};f.show=function(){k();i=a.position(d);i.t+=20;i.l-=30;g.setPosition(i);g.show()};f.hide=function(a){j=setTimeout(function(){g.hide()},600);return!1};f.init();return f}});
STK.register("pl.general.intro.source.init",function(a){return function(b){var c,d,e,f,g,h,i,j,k={},l=a.kit.extra.language,m,n={DOM:{},objs:{},DOM_eventFun:{tipNodeMouseoverFn:function(b){if(!n.objs.bubble){m=a.fixEvent(b).target;n.objs.bubble=a.pl.general.intro.source.bubble.yearGuide(m,m.getAttribute("node-data"))}n.objs.bubble.show()},tipNodeMouseoutFn:function(a){n.objs.bubble.hide(a)}}};c=function(){if(!b)throw new Error("comp.general.intro [ERROR]:node没有定义")};d=function(){n.DOM=a.kit.dom.parseDOM(a.builder(b).list)};e=function(){};f=function(){a.addEvent(n.DOM.tipNode,"mouseover",n.DOM_eventFun.tipNodeMouseoverFn);a.addEvent(n.DOM.tipNode,"mouseout",n.DOM_eventFun.tipNodeMouseoutFn)};g=function(){};h=function(){};i=function(){if(n){a.foreach(n.objs,function(a){a.destroy&&a.destroy()});n=null}};j=function(){c();d();e();f();g();h()};j();k.destroy=i;return k}});
STK.pageletM.register("pl.general.intro.index",function(a){var b="pl_general_intro",c=a.E(b),d=a.pl.general.intro.source.init({node:c}),e={};e.destroy=function(){d.destroy()};return e});
STK.register("pl.home.picShow.source.swtichByBtnlist",function(a){var b="switch";return function(c,d,e,f){function q(){l.add("switchTo","mouseover",p);a.custEvent.add(i,"switch",function(b,c){e[c.preIndex]&&a.removeClassName(e[c.preIndex],"current");e[c.index]&&a.addClassName(e[c.index],"current")});o()}function p(a){var b=a.data.index-0;if(b!=g){n(b);o();return!1}}function o(){clearInterval(j);j=setInterval(function(){n((g+1)%d.length)},k)}function n(a){if(!h){h=!0;m(g,a)}}function m(c,e){if(!!d[c]&&!!d[e]){d[c].style.display="none";a.core.dom.setStyle(d[e],"opacity",0);d[e].style.display="";a.tween(d[e],{end:function(){h=!1;g=e},animationType:"linear",duration:400}).play({opacity:1});a.custEvent.fire(i,b,{index:e,preIndex:c})}}var g=0,h=!1,i={},j,k=f||3e3,l=a.delegatedEvent(c);i={switchTo:n,getIndex:function(){return g},destroy:function(){l.distroy();a.custEvent.remove(i,b)}};a.custEvent.define(i,[b]);q();return i}});
STK.register("pl.home.picShow.source.init",function(a){return function(b){var c,d,e,f,g,h,i,j,k={},l={DOM:{},objs:{},DOM_eventFun:{}};c=function(){if(!b.node)throw new Error("pl.home.picShow.source.init [ERROR]:node没有定义")};d=function(){l.DOM=a.kit.dom.parseDOM(a.builder(b.node).list)};e=function(){l.DOM.pic&&l.DOM.btn&&(l.objs.picSwtich=a.pl.home.picShow.source.swtichByBtnlist(l.DOM.moveBox,l.DOM.pic,l.DOM.btn))};f=function(){};g=function(){};h=function(){};i=function(){if(l){a.foreach(l.objs,function(a){a.destroy&&a.destroy()});l=null}};j=function(){c();d();e();f();g();h()};j();k.destroy=i;return k}});
STK.pageletM.register("pl.home.picShow.index",function(a){var b="pl_home_picShow",c=a.E(b),d=a.pl.home.picShow.source.init({node:c}),e={};e.destroy=function(){d.destroy()};return e});
STK.register("ui.litePrompt",function(a){var b=a.kit.extra.language,c=a.core.util.easyTemplate;return function(b,d){var e,f,g,h,i,d=a.parseParam({hideCallback:a.core.func.empty,type:"succM",msg:"",timeout:""},d),j=d.template||'<#et temp data><div class="W_layer" node-type="outer"><div class="bg"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div class="content layer_mini_info_big" node-type="inner"><p class="clearfix"><span class="icon_${data.type}"></span>${data.msg}&nbsp; &nbsp; &nbsp;</p></div></td></tr></tbody></table></div></div></#et>',k=c(j,{type:d.type,msg:b}).toString();f={};g=a.ui.mod.layer(k);i=g.getOuter();a.custEvent.add(g,"hide",function(){a.ui.mask.back();d.hideCallback&&d.hideCallback();a.custEvent.remove(g,"hide",arguments.callee);clearTimeout(h)});a.custEvent.add(g,"show",function(){document.body.appendChild(i);a.ui.mask.showUnderNode(i);a.ui.mask.getNode().style.zIndex=10002});g.show();d.timeout&&(h=setTimeout(g.hide,d.timeout));var l=a.core.util.winSize(),m=g.getSize(!0);i.style.top=a.core.util.scrollPos().top+(l.height-m.h)/2+"px";i.style.left=(l.width-m.w)/2+"px";i.style.zIndex=10002;f.layer=g;return f}});
STK.register("common.extra.shine",function(a){var b=function(a){return a.slice(0,a.length-1).concat(a.concat([]).reverse())};return function(c,d){var e=a.parseParam({start:"#fff",color:"#fbb",times:2,step:5,length:4},d),f=e.start.split(""),g=e.color.split(""),h=[];for(var i=0;i<e.step;i+=1){var j=f[0];for(var k=1;k<e.length;k+=1){var l=parseInt(f[k],16),m=parseInt(g[k],16);j+=Math.floor(parseInt(l+(m-l)*i/e.step,10)).toString(16)}h.push(j)}for(var i=0;i<e.times;i+=1)h=b(h);var n=!1,o=a.timer.add(function(){if(!h.length)a.timer.remove(o);else{if(n){n=!1;return}n=!0;c.style.backgroundColor=h.pop()}})}});
STK.register("common.trans.message",function(a){var b=a.kit.io.inter(),c=b.register;c("create",{url:"/aj/message",method:"post"});c("createv5",{url:"/aj/directmessage",method:"post"});return b});
STK.register("pl.home.service.source.sendMessage",function(a){var b=a.kit.extra.language,c=300,d=b("#L{请输入对方昵称}"),e=function(a,c){c=="normal"?a.innerHTML=b("#L{发送}"):a.innerHTML=b("#L{提交中...}")};return function(f){var g,h,i,j,k,l,m,n,o={},p,q,r,s=!1,t={DOM:{},objs:{trans:{messageCreate:a.common.trans.message.getTrans("createv5",{onSuccess:function(c){t.unLockSubmit();t.DOM.textEl.value="";t.DOM.textEl.focus();t.objs.dialog.hide();a.ui.litePrompt(b("#L{恭喜，私信发送成功啦！}"),{type:"succM",timeout:"800"})},onError:function(c){t.unLockSubmit();a.ui.alert(c.msg||b("#L{囧，私信发送失败！}"),{icon:"warn"})},onFail:function(c){t.unLockSubmit();a.ui.alert(c.msg||b("#L{囧，私信发送失败！}"),{icon:"warn"})}})}},DEventFun:{clickSubmitBtn:function(a){t.submitIsLock||t.submitMessage()}},publishBtn:function(){var a=r.API.getWords(),b=r.API.count(a),d=b<=c&&b>0?!0:!1;!d||a.length===0?s=!1:s=!0},initLayer:function(){a.addEvent(t.DOM.textEl,"focus",function(){q=setInterval(function(){t.publishBtn()},200)});a.addEvent(t.DOM.textEl,"blur",function(){clearInterval(q)})},lockSubmit:function(){t.submitIsLock=!0;a.addClassName(t.DOM.submit,"W_btn_b_disable");e(t.DOM.btnText,"loading")},unLockSubmit:function(){t.submitIsLock=!1;a.removeClassName(t.DOM.submit,"W_btn_b_disable");e(t.DOM.btnText,"normal")},submitMessage:function(){if(a.trim(t.DOM.screen_name.value)==d||a.trim(t.DOM.screen_name.value).length==0)a.common.extra.shine(t.DOM.screen_name);else{if(!s){a.common.extra.shine(r.nodeList.textEl);return}t.lockSubmit();var b=a.htmlToJson(p);t.objs.trans.messageCreate.request(b)}},show:function(){t.objs.dialog._show();t.initLayer();t.objs.dialog.setMiddle();r.API.focus()},createDialogHtml:function(){var a=f.screen_name?f.screen_name:d,c=f.content?f.content:"",e=f.uid?f.uid:"",g='<div class="detail layer_private_letter" node-type="outer"> <dl class="lpl_box clearfix">  <dt>发&nbsp;&nbsp;给：</dt> <dd>  <input name="screen_name" node-type="screen_name" type="text" value="'+a+'" class="text" readonly>'+'  <input type="hidden" value="'+e+'" name="uid">'+"</dd>"+"<dt>内&nbsp;&nbsp;容：</dt>"+"<dd>"+'  <div class="feed_repeat">'+'    <div class="input clearfix">'+'      <p class="num" node-type="num">#L{还可以输入}<span>300</span>#L{字}</p>'+'      <textarea name="text" rows="" cols="" node-type="textEl">'+c+"</textarea>"+'      <p class="btn"><a href="javascript:void(0);" class="W_btn_b" node-type="submit" action-type="submit"><span node-type="btnText">发送</span></a></p>'+"    </div>"+"  </div>"+"</dd>"+"</dl>"+"</div>";return b(g)}};g=function(){f||(f={});f.title=f.title||b("#L{发私信}")};h=function(){};i=function(){t.objs.dialog=a.ui.dialog({isHold:!0});t.objs.dialog.setTitle(f.title);p=t.objs.dialog.getInner();p.innerHTML=t.createDialogHtml();t.DOM=a.kit.dom.parseDOM(a.builder(p).list);r=t.objs.editor=a.common.editor.base(p,{limitNum:c,count:"enable"});t.objs.dialog._show=t.objs.dialog.show;o=t.objs.dialog};j=function(){t.objs.DEvent=a.core.evt.delegatedEvent(p);t.objs.DEvent.add("submit","click",t.DEventFun.clickSubmitBtn)};k=function(){};l=function(){};m=function(){if(t){a.foreach(t.objs.trans,function(a){a.abort()});t.objs.dialog&&t.objs.dialog.hide();a.foreach(t.objs,function(a){a.destroy&&a.destroy()});t=null}};n=function(){g();h();i();j();k();l()};n();o.destroy=m;o.show=t.show;return o}});
STK.register("pl.home.service.source.init",function(a){var b=a.kit.extra.language,c='<a href="javascript:void(0);" class="W_addbtn_es"> <img src="http://img.t.sinajs.cn/t4/style/images/common/transparent.gif?v=201308221556" alt="已关注" title="已关注" class="addicon">已关注\n\t</a>';return function(b){var d,e,f,g,h,i,j,k,l,m={},n,o,p={DOM:{},objs:{},DOM_eventFun:{sendMessageClickFn:function(b){n||(n=a.pl.home.service.source.sendMessage(b.data));setTimeout(function(){n.show()},0);return!1},changeView:function(){if(!p.DOM.display_new_page)return!1;var b={};a.common.trans.vip.getTrans("changeView",{onComplete:function(a){a.code==="100000"&&(p.DOM.changeview[0].innerHTML=a.data)}}).request(b)},followClickFn:function(b){a.common.trans.relation.getTrans("follow",{onSuccess:function(a){a.code==="100000"&&(p.DOM.followBtnBox[0].innerHTML=c)},onError:function(b){a.ui.alert(b.msg,{icon:warn})}}).request(b.data)}}};e=function(){d=b.node;if(!d)throw new Error("comp.home.service [ERROR]:node没有定义")};f=function(){p.DOM=a.builder(d).list};g=function(){};h=function(){o=a.core.evt.delegatedEvent(b.node);o.add("sendMessage","click",p.DOM_eventFun.sendMessageClickFn);o.add("follow","click",p.DOM_eventFun.followClickFn)};i=function(){};j=function(){};k=function(){if(p){a.foreach(p.objs,function(a){a.destroy&&a.destroy()});p=null}};l=function(){e();f();g();h();i();j()};l();m.destroy=k;return m}});
STK.pageletM.register("pl.home.service.index",function(a){var b="pl_home_service",c=a.E(b),d=a.pl.home.service.source.init({node:c}),e={};e.destroy=function(){d.destroy()};return e});
STK.pageletM.start();
